I"ø<h1 id="gambar-table-user-dan-table-profile">gambar table user dan table profile</h1>
<p><img src="http://localhost:4000/assets/images/post/1.jpg" alt="Table1" />
<img src="http://localhost:4000/assets/images/post/2.jpg" alt="Table2" /></p>

<h1 id="delete-2-table-dengan-satu-query">Delete 2 table dengan satu query</h1>

<p>Halo sobat coders semuanya ! â€¦.<br />
kali ini saya akan membagikan trick seputar Database mysql, dalam tips kali ini saya mempunyai 2 table dalam satu database yang sama.<br />
seperti pada gambar table diatas, table1 itu saya asumsikan sebagai table user dan table2 saya asumsikan dengan table profile.</p>

<p>di table user diatas terdapat foreign key untuk nilai <strong>id_profile</strong>, nah foreign key ini saya hubungkan ke primary key dari table profile dengan nilai yang sama yaitu <strong>id_profile</strong>. nilai ini yang akan saya ambil untuk dijadikan kunci pembuka query antar table.</p>

<p><img src="http://localhost:4000/assets/images/post/3.jpg" alt="foreign" /></p>

<p>untuk tips kali ini saya asumsikan 2 table yaitu table user dan table profile.<br />
dan berikut query untuk delete nya :</p>

<p>jadi rule data saya adalah, dimana saya membuat system untuk aktivasi user, dan aktivasi user dilakukan melalui user role admin â€¦ ( biar admin! ada kerjaan). sebelum melakukan delete kita cek isi table dengan nilai <strong>id_profile</strong> sebagai acuan atau kunci.<br />
algoritma saya jika <strong>id_profile</strong> ini bernilai <em>0</em> berarti nilai nya belum di kirim dan itu berarti statusnya belum aktif. dan selanjutnya melalui user role admin yang bertugas meng aktifasi setiap user yang terdaftar diawal.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="cp">&lt;?php</span>
<span class="c1">//ini adalah query untuk mengambil data</span>
<span class="nv">$conn</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">"localhost"</span><span class="p">,</span> <span class="s2">"user"</span><span class="p">,</span> <span class="s2">"password"</span><span class="p">,</span> <span class="s2">"database"</span><span class="p">);</span>
<span class="nv">$dataJoin</span> <span class="o">=</span> <span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$conn</span><span class="p">,</span> <span class="s2">"SELECT * FROM </span><span class="nv">$table1</span><span class="s2"> INNER JOIN </span><span class="nv">$table2</span><span class="s2"> ON </span><span class="nv">$table1</span><span class="s2">.id = </span><span class="nv">$table2</span><span class="s2">.id_profile WHERE </span><span class="nv">$table1</span><span class="s2">.id = </span><span class="nv">$id</span><span class="s2">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>

<span class="k">if</span><span class="p">(</span> <span class="nv">$dataJoin</span><span class="p">[</span><span class="s1">'id_profile'</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span><span class="o">:</span>
		<span class="c1">//echo true." = Benar "; die;</span>

	<span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$conn</span><span class="p">,</span> <span class="s2">"DELETE </span><span class="nv">$table1</span><span class="s2">, </span><span class="nv">$table2</span><span class="s2"> FROM </span><span class="nv">$table1</span><span class="s2"> INNER JOIN </span><span class="nv">$table2</span><span class="s2"> ON </span><span class="nv">$table1</span><span class="s2">.id_profile=</span><span class="nv">$table2</span><span class="s2">.id_profile WHERE </span><span class="nv">$table1</span><span class="s2">.id_profile = </span><span class="nv">$id</span><span class="s2">"</span><span class="p">);</span>

		<span class="k">return</span> <span class="nf">mysqli_affected_rows</span><span class="p">(</span><span class="nv">$conn</span><span class="p">);</span>
	<span class="k">else</span><span class="o">:</span>
			<span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$conn</span><span class="p">,</span> <span class="s2">"DELETE FROM </span><span class="nv">$table1</span><span class="s2"> WHERE id = </span><span class="nv">$id</span><span class="s2">"</span><span class="p">);</span>
			<span class="k">return</span> <span class="nf">mysqli_affected_rows</span><span class="p">(</span><span class="nv">$conn</span><span class="p">);</span>
	<span class="k">endif</span><span class="p">;</span> 
</code></pre></div></div>

<p>sebetulnya sih untuk menghapus dari 2 table ini bisa dilakukan dua kali query, namun dirasa kurang efektif maka digabungkan dalam satu query. agar server tidak 2 kali kerja.</p>

<p>jika 2 kali query akan seperti ini :</p>
<div class="language-php highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$conn</span><span class="p">,</span> <span class="s2">"DELETE FROM </span><span class="nv">$table1</span><span class="s2"> WHERE id_profile = </span><span class="nv">$id</span><span class="s2">"</span><span class="p">);</span>
<span class="nf">mysqli_query</span><span class="p">(</span><span class="nv">$conn</span><span class="p">,</span> <span class="s2">"DELETE FROM </span><span class="nv">$table2</span><span class="s2"> WHERE id_profile = </span><span class="nv">$id</span><span class="s2">"</span><span class="p">);</span>
</code></pre></div></div>

<p>dengan itu berarti server harus mengulang query delete 2 kali. berikut tampilan system aktivasi user yang saya buat</p>

<p><img src="http://localhost:4000/assets/images/post/4.jpg" alt="aktivasi" /></p>

<p>ok sekian dulu dari saya, semoga bermanfaat.</p>

<p><strong>salam</strong></p>

:ET